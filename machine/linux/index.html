<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基本命令 | Yolo Cloud</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="Yolo Cloud 记录了我技术成长中学到的各种知识,遇到的各种问题">
    
    <link rel="preload" href="/assets/css/0.styles.ef76fb7a.css" as="style"><link rel="preload" href="/assets/js/app.960d02ef.js" as="script"><link rel="preload" href="/assets/js/2.24d0c525.js" as="script"><link rel="preload" href="/assets/js/1.7a21ba49.js" as="script"><link rel="preload" href="/assets/js/42.72b91664.js" as="script"><link rel="prefetch" href="/assets/js/10.f69943f1.js"><link rel="prefetch" href="/assets/js/11.34e45c05.js"><link rel="prefetch" href="/assets/js/12.b3239be8.js"><link rel="prefetch" href="/assets/js/13.9413d238.js"><link rel="prefetch" href="/assets/js/14.274b5f0e.js"><link rel="prefetch" href="/assets/js/15.b4ac1f7e.js"><link rel="prefetch" href="/assets/js/16.8daddce7.js"><link rel="prefetch" href="/assets/js/17.63f0137b.js"><link rel="prefetch" href="/assets/js/18.34297d4a.js"><link rel="prefetch" href="/assets/js/19.f4c3de3f.js"><link rel="prefetch" href="/assets/js/20.5d84dce9.js"><link rel="prefetch" href="/assets/js/21.20e3b23c.js"><link rel="prefetch" href="/assets/js/22.a73ae15d.js"><link rel="prefetch" href="/assets/js/23.caa41f4c.js"><link rel="prefetch" href="/assets/js/24.3eef49c1.js"><link rel="prefetch" href="/assets/js/25.1de21a4c.js"><link rel="prefetch" href="/assets/js/26.d0a0a52c.js"><link rel="prefetch" href="/assets/js/27.0a64e713.js"><link rel="prefetch" href="/assets/js/28.a80b7d7e.js"><link rel="prefetch" href="/assets/js/29.f5497e9f.js"><link rel="prefetch" href="/assets/js/3.6806cde9.js"><link rel="prefetch" href="/assets/js/30.cf1d9459.js"><link rel="prefetch" href="/assets/js/31.3b0ffef1.js"><link rel="prefetch" href="/assets/js/32.fbc55f5a.js"><link rel="prefetch" href="/assets/js/33.89f4a805.js"><link rel="prefetch" href="/assets/js/34.51b6bac0.js"><link rel="prefetch" href="/assets/js/35.ec4fa8a2.js"><link rel="prefetch" href="/assets/js/36.0ee8e55a.js"><link rel="prefetch" href="/assets/js/37.3245ee2a.js"><link rel="prefetch" href="/assets/js/38.443d0216.js"><link rel="prefetch" href="/assets/js/39.0ca01212.js"><link rel="prefetch" href="/assets/js/4.f67e853e.js"><link rel="prefetch" href="/assets/js/40.a876e599.js"><link rel="prefetch" href="/assets/js/41.9875b585.js"><link rel="prefetch" href="/assets/js/43.320a3cc1.js"><link rel="prefetch" href="/assets/js/44.a5b707f2.js"><link rel="prefetch" href="/assets/js/45.e567f15c.js"><link rel="prefetch" href="/assets/js/46.d8e4cdd6.js"><link rel="prefetch" href="/assets/js/47.457e9977.js"><link rel="prefetch" href="/assets/js/48.2588bf85.js"><link rel="prefetch" href="/assets/js/49.e8811e38.js"><link rel="prefetch" href="/assets/js/5.1df2bba8.js"><link rel="prefetch" href="/assets/js/50.381a613f.js"><link rel="prefetch" href="/assets/js/51.879677f2.js"><link rel="prefetch" href="/assets/js/52.38a2c925.js"><link rel="prefetch" href="/assets/js/53.992c4d50.js"><link rel="prefetch" href="/assets/js/54.ded5d7bd.js"><link rel="prefetch" href="/assets/js/55.de1f9f48.js"><link rel="prefetch" href="/assets/js/56.6a9f5bd8.js"><link rel="prefetch" href="/assets/js/57.b062df7f.js"><link rel="prefetch" href="/assets/js/6.9a9e67e1.js"><link rel="prefetch" href="/assets/js/7.d584804c.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.d852a880.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ef76fb7a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Yolo Cloud</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="https://github.com/linG5821" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="https://github.com/linG5821" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/machine/" class="sidebar-heading clickable router-link-active open"><span>机器环境</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/machine/windows/" class="sidebar-link">Windows</a></li><li><a href="/machine/windows/envlist.html" class="sidebar-link">Windows配置清单</a></li><li><a href="/machine/windows/terminal.html" class="sidebar-link">Windows终端打造</a></li><li><a href="/machine/windows/wsl.html" class="sidebar-link">WSL</a></li><li><a href="/machine/mac/" class="sidebar-link">Mac</a></li><li><a href="/machine/linux/" aria-current="page" class="active sidebar-link">Linux</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/machine/linux/#基本命令" class="sidebar-link">基本命令</a></li><li class="sidebar-sub-header"><a href="/machine/linux/#常用命令收集" class="sidebar-link">常用命令收集</a></li><li class="sidebar-sub-header"><a href="/machine/linux/#定制化" class="sidebar-link">定制化</a></li><li class="sidebar-sub-header"><a href="/machine/linux/#性能优化" class="sidebar-link">性能优化</a></li><li class="sidebar-sub-header"><a href="/machine/linux/#常用软件安装与配置" class="sidebar-link">常用软件安装与配置</a></li><li class="sidebar-sub-header"><a href="/machine/linux/#其他问题" class="sidebar-link">其他问题</a></li></ul></li></ul></section></li><li><a href="/network/" class="sidebar-link">网络编程</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/database/" class="sidebar-heading clickable"><span>数据库</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/middleware/" class="sidebar-heading clickable"><span>中间件</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/container/" class="sidebar-heading clickable"><span>容器技术</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/tool/" class="sidebar-heading clickable"><span>常用工具</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/security/" class="sidebar-heading clickable"><span>安全技术</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/java/" class="sidebar-heading clickable"><span>Java</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/go/" class="sidebar-link">Go</a></li><li><a href="/php/" class="sidebar-link">PHP</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/ai/" class="sidebar-heading clickable"><span>人工智能</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="基本命令"><a href="#基本命令" class="header-anchor">#</a> 基本命令</h2> <ul><li><p>文件处理命令</p></li> <li><p>权限管理命令</p></li> <li><p>文件搜索命令</p></li> <li><p>帮助命令</p> <div class="language-shell extra-class"><pre class="language-shell"><code>  <span class="token function">man</span> 命令或者配置文件 <span class="token comment"># 查看命令的描述 /选项 查看对应选项的含义</span>
                   <span class="token comment"># 查看配置文件存放的信息以及文件的格式</span>
  whatis 命令 <span class="token comment"># 查看命令的描述</span>
  <span class="token function">apropos</span> 配置文件 <span class="token comment"># 查看配置文件的描述</span>
  命令 <span class="token parameter variable">--help</span> 查看命令的帮助信息
  info 与man类似 浏览方式更便捷
  <span class="token builtin class-name">help</span> <span class="token comment"># 查看shell内置命令帮助 例如 cd</span>
</code></pre></div></li> <li><p>用户管理命令</p> <div class="language-shell extra-class"><pre class="language-shell"><code>  <span class="token function">useradd</span> 用户名  <span class="token comment">#添加用户</span>
  <span class="token function">passwd</span>  用户名  <span class="token comment">#设置密码</span>
  <span class="token function">who</span>    <span class="token comment">#查看登陆用户信息</span>
  w      <span class="token comment">#查看登陆用户信息(稍微详细)</span>
  <span class="token function">uptime</span> <span class="token comment">#查看当前机器运行时间(load average 代表1, 5, 15分钟的负载)</span>

</code></pre></div></li> <li><p>压缩解压命令</p> <div class="language-shell extra-class"><pre class="language-shell"><code>  <span class="token comment"># gzip (只能压缩文件)</span>
  <span class="token function">gzip</span> 文件名  <span class="token comment">#压缩</span>
  gunzip 文件名 / <span class="token function">gzip</span> <span class="token parameter variable">-d</span> 文件名 <span class="token comment">#解压缩</span>

  <span class="token comment"># tar</span>
  <span class="token parameter variable">-c</span>  打包
  <span class="token parameter variable">-v</span>  显示详细信息
  <span class="token parameter variable">-f</span>  指定文件名
  <span class="token parameter variable">-z</span>  打包同时压缩,使用gzip格式压缩
  <span class="token parameter variable">-f</span>  打包同时压缩,使用bz2格式压缩
  <span class="token parameter variable">-x</span>  解包

  <span class="token comment"># 常用组合 </span>
  <span class="token function">tar</span> <span class="token parameter variable">-zcvf</span> 压缩后文件名 压缩文件/目录
  <span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> 压缩文件名 <span class="token parameter variable">-C</span> 目标目录<span class="token punctuation">(</span>不指定-C默认解压到当前目录<span class="token punctuation">)</span>

  <span class="token comment"># zip</span>
  <span class="token function">zip</span> <span class="token punctuation">[</span>-r<span class="token punctuation">]</span> <span class="token punctuation">[</span>压缩后文件名<span class="token punctuation">]</span> <span class="token punctuation">[</span>压缩文件<span class="token punctuation">]</span> <span class="token comment"># -r 可以压缩目录</span>
  <span class="token function">unzip</span> <span class="token punctuation">[</span>压缩文件<span class="token punctuation">]</span> <span class="token comment"># 解压缩 目录已经存在可以使用 -o 覆盖不询问</span>

  <span class="token comment"># bzip2</span>
  <span class="token comment"># gizp 升级版 压缩比高 -k 参数可以保留源文件 压缩格式bz2</span>
  <span class="token function">bzip2</span> 文件名 <span class="token comment"># 压缩 -k 参数保留源文件</span>
  bunzip2 文件名 <span class="token comment"># 解压缩 -k 保留压缩包</span>
</code></pre></div></li> <li><p>网络命令</p> <div class="language-shell extra-class"><pre class="language-shell"><code>  <span class="token function">write</span> <span class="token punctuation">[</span>用户名<span class="token punctuation">]</span> <span class="token comment"># 给指定在线用户发送信息</span>
  wall <span class="token punctuation">[</span>消息内容<span class="token punctuation">]</span> <span class="token comment"># 给所有在线用户发送广播</span>
  <span class="token function">ping</span> <span class="token punctuation">[</span>IP地址<span class="token punctuation">]</span> <span class="token comment"># 测试网络连通性</span>
      <span class="token parameter variable">-c</span> 指定ping的次数
  <span class="token function">ifconfig</span> <span class="token comment">#查看和设置网络信息</span>
      <span class="token punctuation">[</span>网卡<span class="token punctuation">]</span> <span class="token punctuation">[</span>IP<span class="token punctuation">]</span> 设置IP地址
  <span class="token comment"># 网络信息配置文件</span>
  /etc/sysconfig/network-scripts/ifcfg-eth0 <span class="token comment"># 配置IP地址等信息</span>
  /etc/sysconfig/network <span class="token comment"># 配置hostname</span>
  /etc/resolv.conf <span class="token comment"># 修改DNS服务器配置</span>

  mail <span class="token punctuation">[</span>用户名<span class="token punctuation">]</span> <span class="token comment"># 给指定用户发送邮件</span>
  last <span class="token comment"># 列出目前及历史用户登录的信息</span>
  lastlog <span class="token comment"># 查看用户的最后一次的登录信息</span>
  <span class="token function">traceroute</span> <span class="token punctuation">[</span>域名/IP<span class="token punctuation">]</span> <span class="token comment"># 追踪数据包的路径</span>
  <span class="token function">netstat</span>  <span class="token comment"># 查看网络状态</span>
      <span class="token parameter variable">-t</span> 查询TCP网络信息
      <span class="token parameter variable">-u</span> 查询UDP网络信息
      <span class="token parameter variable">-l</span> 监听
      <span class="token parameter variable">-r</span> 路由
      <span class="token parameter variable">-n</span> 显示IP地址和端口号
  <span class="token comment"># 范例</span>
  <span class="token function">netstat</span> <span class="token parameter variable">-tlun</span> <span class="token comment"># 查看当前计算机开了哪些端口</span>
  <span class="token function">netstat</span> <span class="token parameter variable">-an</span> <span class="token comment"># 查看所有的监听信息</span>
  <span class="token function">netstat</span> <span class="token parameter variable">-rn</span> <span class="token comment"># 查看路由表</span>
</code></pre></div></li> <li><p>挂载/卸载命令</p> <div class="language-shell extra-class"><pre class="language-shell"><code>  <span class="token comment"># 挂载</span>
  <span class="token function">mount</span> <span class="token parameter variable">-t</span> <span class="token punctuation">[</span>文件系统<span class="token punctuation">]</span> <span class="token punctuation">[</span>设备名称<span class="token punctuation">]</span> <span class="token punctuation">[</span>挂载目录<span class="token punctuation">]</span>

  <span class="token comment"># 卸载</span>
  <span class="token function">umount</span> <span class="token punctuation">[</span>设备名称<span class="token punctuation">]</span>
</code></pre></div></li> <li><p>关机/重启命令</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">shutdown</span> 
 <span class="token parameter variable">-c</span> 取消前一个关机命令
 <span class="token parameter variable">-h</span> 关机 <span class="token punctuation">[</span>时间<span class="token punctuation">]</span>
 <span class="token parameter variable">-r</span> 重启 <span class="token punctuation">[</span>时间<span class="token punctuation">]</span>
</code></pre></div></li></ul> <h2 id="常用命令收集"><a href="#常用命令收集" class="header-anchor">#</a> 常用命令收集</h2> <ol><li><p>根据端口号批量kill</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token punctuation">{</span>port<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-c</span> <span class="token number">9</span>-15 <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">kill</span> <span class="token parameter variable">-9</span>
<span class="token function">ps</span> aux<span class="token operator">|</span><span class="token function">grep</span> process_name <span class="token operator">|</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token function">grep</span><span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{print $2}'</span><span class="token operator">|</span><span class="token function">xargs</span> <span class="token function">kill</span> <span class="token parameter variable">-9</span> 
</code></pre></div></li> <li><p>nohup 运行jar程序时指定jar包的路径为绝对路径，这样jps可以显示正确的java项目的名称，使用相对路径只会显示jar</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">nohup</span> <span class="token function">java</span> <span class="token parameter variable">-jar</span> /home/xxx.jar <span class="token operator">&gt;</span> /dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
</code></pre></div></li> <li><p>获取上一条命令的执行结果 $?</p></li> <li><p>Redis删除统配符</p> <div class="language-shell extra-class"><pre class="language-shell"><code>redis-cli <span class="token parameter variable">-h</span> <span class="token punctuation">{</span>host<span class="token punctuation">}</span> <span class="token parameter variable">-a</span> crs-2xexfxav:Frezzen2sweng keys <span class="token string">&quot;xxx*&quot;</span> <span class="token operator">|</span> <span class="token function">xargs</span> redis-cli <span class="token parameter variable">-h</span> <span class="token punctuation">{</span>host<span class="token punctuation">}</span> <span class="token parameter variable">-a</span> crs-2xexfxav:Frezzen2sweng del
</code></pre></div></li> <li><p>获取当前进程的线程</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">ps</span> p <span class="token variable">${pid}</span> <span class="token parameter variable">-L</span> <span class="token parameter variable">-o</span> pcpu,pmem,pid,tid,time,tname,cmd // 线程明细
<span class="token function">ps</span> p <span class="token variable">${pid}</span> <span class="token parameter variable">-L</span> <span class="token parameter variable">-o</span> pcpu,pmem,pid,tid,time,tname,cmd <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span> // 线程明细
</code></pre></div></li> <li><p>查看本机的网络连接数</p> <div class="language-shell extra-class"><pre class="language-shell"><code>ss <span class="token parameter variable">-s</span> <span class="token operator">&amp;&amp;</span> <span class="token function">free</span> <span class="token parameter variable">-g</span>
</code></pre></div></li> <li><p>查看CPU核数及序号</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">cat</span> /proc/cpuinfo <span class="token operator">|</span> <span class="token function">grep</span> processor
</code></pre></div></li> <li><p>获取占用磁盘最大的前几个</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">du</span> <span class="token parameter variable">-h</span> <span class="token parameter variable">-BM</span> <span class="token punctuation">{</span>file_path<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-nr</span> <span class="token operator">|</span><span class="token function">head</span> <span class="token parameter variable">-n3</span>
</code></pre></div></li> <li><p>查看系统oom日志</p> <div class="language-shell extra-class"><pre class="language-shell"><code>journalctl <span class="token parameter variable">-k</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-i</span> <span class="token parameter variable">-e</span> memory <span class="token parameter variable">-e</span> oom
</code></pre></div></li></ol> <h2 id="定制化"><a href="#定制化" class="header-anchor">#</a> 定制化</h2> <h3 id="更换镜像源"><a href="#更换镜像源" class="header-anchor">#</a> 更换镜像源</h3> <ul><li><p>Ubuntu镜像源更换</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 1.首先将原配置文件备份</span>
<span class="token function">sudo</span> <span class="token function">cp</span> /etc/apt/sources.list /etc/apt/sources.list.20181013
<span class="token comment"># 2.然后 VIM 打开，替换</span>
:%s/security.ubuntu/mirrors.aliyun/g
:%s/archive.ubuntu/mirrors.aliyun/g
<span class="token comment"># 3.更新</span>
<span class="token function">sudo</span> <span class="token function">apt</span> update
</code></pre></div></li></ul> <h2 id="性能优化"><a href="#性能优化" class="header-anchor">#</a> 性能优化</h2> <ol><li><p>内核参数优化示例</p> <div class="language-shell extra-class"><pre class="language-shell"><code>//内核参数调整
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf</span>
fs.file-max=2097152 
fs.nr_open=2097152
net.core.somaxconn=32768
net.ipv4.tcp_max_syn_backlog=16384
net.core.netdev_max_backlog=16384
net.ipv4.ip_local_port_range=1000 65535
net.core.rmem_default=262144
net.core.wmem_default=262144
net.core.rmem_max=16777216
net.core.wmem_max=16777216
net.core.optmem_max=16777216
net.ipv4.tcp_rmem=1024 4096 16777216
net.ipv4.tcp_wmem=1024 4096 16777216
net.nf_conntrack_max=1000000
net.netfilter.nf_conntrack_max=1000000
net.netfilter.nf_conntrack_tcp_timeout_time_wait=30
net.ipv4.tcp_max_tw_buckets=1048576
net.ipv4.tcp_fin_timeout = 15
EOF</span>

<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;&gt;</span>/etc/security/limits.conf</span>
*      soft   nofile      1048576
*      hard   nofile      1048576
EOF</span>

<span class="token builtin class-name">echo</span> <span class="token assign-left variable">DefaultLimitNOFILE</span><span class="token operator">=</span><span class="token number">1048576</span> <span class="token operator">&gt;&gt;</span>/etc/systemd/system.conf

//网络参数调整
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf</span>
net.ipv4.tcp_tw_reuse=1
net.ipv4.tcp_tw_recycle=1
net.ipv4.tcp_fin_timeout=30
net.ipv4.tcp_syncookies = 1
EOF</span>
</code></pre></div></li></ol> <h2 id="常用软件安装与配置"><a href="#常用软件安装与配置" class="header-anchor">#</a> 常用软件安装与配置</h2> <ul><li><p>Centos 安装 Supervisor</p> <ol><li><p>pip方式安装</p> <div class="language-shell extra-class"><pre class="language-shell"><code>yum <span class="token function">install</span> python-setuptools
easy_install pip
pip <span class="token function">install</span> supervisor
</code></pre></div></li> <li><p>源代码安装</p> <div class="language-shell extra-class"><pre class="language-shell"><code>get https://files.pythonhosted.org/packages/de/87/ee1ad8fa533a4b5f2c7623f4a2b585d3c1947af7bed8e65bc7772274320e/supervisor-4.1.0.tar.gz
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> supervisor-4.1.0.tar.gz
<span class="token builtin class-name">cd</span> supervisor-4.1.0
<span class="token function">sudo</span> python setup.py <span class="token function">install</span>
<span class="token comment">## 如果报meld3版本的问题</span>
<span class="token function">wget</span> http://www.plope.com/software/meld3/meld3-0.6.5.tar.gz
<span class="token function">tar</span> <span class="token parameter variable">-xf</span> meld3-0.6.5.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> meld3-0.6.5
python setup.py <span class="token function">install</span>
</code></pre></div></li> <li><p>生成配置</p> <div class="language-shell extra-class"><pre class="language-shell"><code>echo_supervisord_conf <span class="token operator">&gt;</span> /usr/local/etc/supervisord.conf
<span class="token comment"># 为了不将所有新增配置信息全写在一个配置文件里，这里新建一个文件夹，每个程序设置一个配置文件，相互隔离</span>
<span class="token function">mkdir</span> /usr/local/etc/supervisor.d/
<span class="token comment"># 修改配置 加入以下配置</span>
<span class="token function">vim</span> /usr/local/etc/supervisord.conf
<span class="token punctuation">[</span>include<span class="token punctuation">]</span>
files <span class="token operator">=</span> /usr/local/etc/supervisor.d/*.ini
<span class="token comment"># 在supervisord.conf中设置通过web可以查看管理的进程，加入以下代码（默认即有，取消注释即可）    </span>
<span class="token punctuation">[</span>inet_http_server<span class="token punctuation">]</span> 
<span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">9001</span>
<span class="token assign-left variable">username</span><span class="token operator">=</span>user      
<span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token number">123</span>
</code></pre></div></li> <li><p>配置Service</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">vim</span> /usr/lib/systemd/system/supervisord.service

<span class="token comment"># 内容</span>
<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Process Monitoring and Control Daemon
<span class="token assign-left variable">After</span><span class="token operator">=</span>rc-local.service nss-user-lookup.target

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token comment"># 添加EnvironmentFile 或者 Environment 可以在service模式下使用环境变量 但是Service启动方式无法读取配置在系统环境变量中的值 是因为通过命令行启动方式和通过systemd的方式有差别导致的</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/bin/supervisord <span class="token parameter variable">-c</span> /usr/local/etc/supervisord.conf

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target


<span class="token comment">#设置开机启动</span>
systemctl <span class="token builtin class-name">enable</span> supervisord.service
</code></pre></div></li></ol></li> <li><p>Centos7 安装服务器版 Chrome</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> google-chrome-stable_current_x86_64.rpm
yum <span class="token function">install</span> pax*
yum <span class="token function">install</span> redhat-lsb*
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> libXss*
yum <span class="token function">install</span> libappindicator*
yum <span class="token function">install</span> liberation-fonts
</code></pre></div></li> <li><p>iptables 使用</p></li></ul> <ol><li><p>开放端口</p></li> <li><p>端口转发</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 单次即时生效</span>
<span class="token builtin class-name">echo</span> <span class="token number">1</span> <span class="token operator">&gt;</span> /proc/sys/net/ipv4/ip_forward
<span class="token comment"># 永久生效</span>
<span class="token function">vi</span> /etc/sysctl.conf
<span class="token comment">## 启用包过滤功能 </span>
net.ipv4.ip_forward <span class="token operator">=</span> <span class="token number">1</span> 
<span class="token comment">## 即时加载配置</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-p</span>
<span class="token comment">## 显示所有系统参数</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-a</span>
可以看到net.ipv4.ip_forward <span class="token operator">=</span> <span class="token number">1</span>  
配置转发规则，如下示例是将26.xx.x.2:10001（云服务器外网地址，端口可自行选择）的访问转发至内网为10.0.0.5:6379的 Redis 实例。
iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> PREROUTING <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">10001</span> <span class="token parameter variable">-j</span> DNAT --to-destination <span class="token number">10.0</span>.0.5:6379
iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-A</span> POSTROUTING <span class="token parameter variable">-d</span> <span class="token number">10.0</span>.0.5 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">6379</span> <span class="token parameter variable">-j</span> MASQUERADE
</code></pre></div></li></ol> <h2 id="其他问题"><a href="#其他问题" class="header-anchor">#</a> 其他问题</h2> <ul><li><p>VIRT占用内存过大</p> <p>大致的原因是从glibc2.11版本开始，linux为了解决多线程下内存分配竞争而引起的性能问题，增强了动态内存分配行为，使用了一种叫做arena的memory pool,在64位系统下面缺省配置是一个arena大小为64M，一个进程可以最多有cpu cores * 8个arena。假设机器是8核的，那么最多可以有8 * 8 = 64个arena，也就是会使用64 * 64 = 4096M内存。然而我们可以通过设置系统环境变量来改变arena的数量：export MALLOC_ARENA_MAX=8（一般建议配置程序cpu核数）配置环境变量使其生效，再重启该jvm进程，VIRT比之前少了快2个G</p></li> <li><p>Centos6 Autoconf version 2.64 or higher is required</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">rpm</span> <span class="token parameter variable">-qf</span> /usr/bin/autoconf
<span class="token function">rpm</span> <span class="token parameter variable">-e</span> <span class="token parameter variable">--nodeps</span> autoconf-2.63
<span class="token function">wget</span> ftp://ftp.gnu.org/gnu/autoconf/autoconf-2.69.tar.gz
<span class="token function">tar</span> zxvf autoconf-2.69.tar.gz
<span class="token builtin class-name">cd</span> autoconf-2.69
./configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr/
<span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
</code></pre></div></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">4/24/2025, 7:01:22 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/machine/mac/" class="prev">
        Mac
      </a></span> <span class="next"><a href="/network/">
        网络编程
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.960d02ef.js" defer></script><script src="/assets/js/2.24d0c525.js" defer></script><script src="/assets/js/1.7a21ba49.js" defer></script><script src="/assets/js/42.72b91664.js" defer></script>
  </body>
</html>
